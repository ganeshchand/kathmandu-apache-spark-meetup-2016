<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<title>chap5_example - Databricks</title>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel='stylesheet' type='text/css' href='https://databricks-prod-cloudfront.cloud.databricks.com/static/201511031715010800-b38c68475dfc920d015b8b9c64a2676d63f65035/notebook.css'></style>
<style media='print'>
#context-bar,div.top-menu-buttons,div.globalComments,div.commentsPane,.tb-title-icons,#topbar,#user-menu{position:relative !important}#help-menu{position:relative !important}#topbar{display:block !important;height:auto !important}.tb-button{display:none !important}.tb-title-wrapper{text-align:left !important;margin:0;left:0;white-space:initial;position:relative}.tb-title-lang{display:none !important}#overallView{left:0 !important}#content{position:relative !important;display:block !important;top:0 !important;left:0 !important}.command-provenance{visibility:visible !important;opacity:1 !important}#context-bar,div.top-menu-buttons,div.globalComments,div.commentsPane,.tb-title-icons,#tooltip,#filebrowser-popup,#searchpanel-popup,#user-menu{display:none !important}.submit-hint,a[class*="-button"],i[class*="icon-"],select{display:none !important}.results .plot-controls{display:none !important}a[class="cancel-query-button"]{display:block !important}.tb-status,.tb-status img{display:none !important}.command-result .spinner .spinner-wrapper{display:none !important}html,body,.shellSessionView{overflow:hidden !important}textarea:empty{display:none !important}div.primaryPrompt{display:none !important}div.divider{display:none !important}.command{border:none !important}*::-webkit-input-placeholder{color:tranparent}*:-moz-placeholder{color:tranparent}*::-moz-placeholder{color:tranparent}*:-ms-input-placeholder{color:tranparent}.expandingText{min-height:initial !important}.commentFrame .comment-list li{margin:0}.commentFrame .header{display:none !important}.commentFrame .new-comment{border-bottom:none !important}div.divider:hover{display:none !important}div.divider:hover .btn-circle{display:none !important}.command:hover,.command:active{border:none !important;box-shadow:none !important}@page{margin:2cm}body{max-width:100% !important}.ui-resizable{max-height:100%;max-width:100%}.figure-results-and-comments .widget[style*="width: auto; height: auto"]{width:100% !important;min-height:300px}.widget.widget-input{min-height:initial !important}@-moz-document url-prefix(){.ui-resizable{width:auto !important;height:auto !important;max-width:100%}}img,.figure,.ui-resizeable{page-break-inside:avoid}.previousPrompt{page-break-inside:avoid}.command .command-input .command-box{page-break-before:avoid}.results-and-comments{page-break-before:avoid}.results-and-comments.figure-results-and-comments{page-break-before:auto;page-break-inside:avoid}.command .ui-resizeable{page-break-inside:avoid}.table-bordered{border:1px solid #ddd}.results .table thead,.table thead{background:#fafafa}.command-result-wrapper .results{overflow:hidden}.results-table .inner{overflow:hidden}#content{overflow-y:visible}.commentFrame{overflow:visible;margin-bottom:25px}.commentFrame .new-comment{border-bottom:none}.commentFrame .main,.commentFrame .comment-list{overflow-y:visible;max-height:initial;height:auto}.sessionPane .shell-top>div:last-child .results{padding-bottom:50px;overflow:visible}
/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByaW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx5R0FBeUcsNEJBQTRCLENBQUMsV0FBVyw0QkFBNEIsQ0FBQyxRQUFRLHlCQUF5QixzQkFBc0IsQ0FBQyxXQUFXLHVCQUF1QixDQUFDLGtCQUFrQiwyQkFBMkIsU0FBUyxPQUFPLG9CQUFvQixpQkFBaUIsQ0FBQyxlQUFlLHVCQUF1QixDQUFDLGFBQWEsaUJBQWlCLENBQUMsU0FBUyw2QkFBNkIseUJBQXlCLGlCQUFpQixpQkFBaUIsQ0FBQyxvQkFBb0IsOEJBQThCLG9CQUFvQixDQUFDLGdKQUFnSix1QkFBdUIsQ0FBQywwREFBMEQsdUJBQXVCLENBQUMsd0JBQXdCLHVCQUF1QixDQUFDLCtCQUErQix3QkFBd0IsQ0FBQywwQkFBMEIsdUJBQXVCLENBQUMsMENBQTBDLHVCQUF1QixDQUFDLDRCQUE0QiwwQkFBMEIsQ0FBQyxlQUFlLHVCQUF1QixDQUFDLGtCQUFrQix1QkFBdUIsQ0FBQyxZQUFZLHVCQUF1QixDQUFDLFNBQVMsc0JBQXNCLENBQUMsNkJBQTZCLGdCQUFnQixDQUFDLG1CQUFtQixnQkFBZ0IsQ0FBQyxvQkFBb0IsZ0JBQWdCLENBQUMsd0JBQXdCLGdCQUFnQixDQUFDLGVBQWUsNkJBQTZCLENBQUMsK0JBQStCLFFBQVEsQ0FBQyxzQkFBc0IsdUJBQXVCLENBQUMsMkJBQTJCLDZCQUE2QixDQUFDLGtCQUFrQix1QkFBdUIsQ0FBQyw4QkFBOEIsdUJBQXVCLENBQUMsK0JBQStCLHVCQUF1QiwwQkFBMEIsQ0FBQyxNQUFNLFVBQVUsQ0FBQyxLQUFLLHlCQUF5QixDQUFDLGNBQWMsZ0JBQWdCLGNBQWMsQ0FBQyx5RUFBeUUsc0JBQXNCLGdCQUFnQixDQUFDLHFCQUFxQiw2QkFBNkIsQ0FBQyw0QkFBNEIsY0FBYyxzQkFBc0IsdUJBQXVCLGNBQWMsQ0FBQyxDQUFDLDJCQUEyQix1QkFBdUIsQ0FBQyxnQkFBZ0IsdUJBQXVCLENBQUMscUNBQXFDLHVCQUF1QixDQUFDLHNCQUFzQix1QkFBdUIsQ0FBQyxrREFBa0QsdUJBQXVCLHVCQUF1QixDQUFDLHdCQUF3Qix1QkFBdUIsQ0FBQyxnQkFBZ0IscUJBQXFCLENBQUMsbUNBQW1DLGtCQUFrQixDQUFDLGlDQUFpQyxlQUFlLENBQUMsc0JBQXNCLGVBQWUsQ0FBQyxTQUFTLGtCQUFrQixDQUFDLGNBQWMsaUJBQWlCLGtCQUFrQixDQUFDLDJCQUEyQixrQkFBa0IsQ0FBQyxnREFBZ0QsbUJBQW1CLG1CQUFtQixXQUFXLENBQUMsZ0RBQWdELG9CQUFvQixnQkFBZ0IsQ0FBQyIsImZpbGUiOiJwcmludC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjY29udGV4dC1iYXIsZGl2LnRvcC1tZW51LWJ1dHRvbnMsZGl2Lmdsb2JhbENvbW1lbnRzLGRpdi5jb21tZW50c1BhbmUsLnRiLXRpdGxlLWljb25zLCN0b3BiYXIsI3VzZXItbWVudXtwb3NpdGlvbjpyZWxhdGl2ZSAhaW1wb3J0YW50fSNoZWxwLW1lbnV7cG9zaXRpb246cmVsYXRpdmUgIWltcG9ydGFudH0jdG9wYmFye2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudDtoZWlnaHQ6YXV0byAhaW1wb3J0YW50fS50Yi1idXR0b257ZGlzcGxheTpub25lICFpbXBvcnRhbnR9LnRiLXRpdGxlLXdyYXBwZXJ7dGV4dC1hbGlnbjpsZWZ0ICFpbXBvcnRhbnQ7bWFyZ2luOjA7bGVmdDowO3doaXRlLXNwYWNlOmluaXRpYWw7cG9zaXRpb246cmVsYXRpdmV9LnRiLXRpdGxlLWxhbmd7ZGlzcGxheTpub25lICFpbXBvcnRhbnR9I292ZXJhbGxWaWV3e2xlZnQ6MCAhaW1wb3J0YW50fSNjb250ZW50e3Bvc2l0aW9uOnJlbGF0aXZlICFpbXBvcnRhbnQ7ZGlzcGxheTpibG9jayAhaW1wb3J0YW50O3RvcDowICFpbXBvcnRhbnQ7bGVmdDowICFpbXBvcnRhbnR9LmNvbW1hbmQtcHJvdmVuYW5jZXt2aXNpYmlsaXR5OnZpc2libGUgIWltcG9ydGFudDtvcGFjaXR5OjEgIWltcG9ydGFudH0jY29udGV4dC1iYXIsZGl2LnRvcC1tZW51LWJ1dHRvbnMsZGl2Lmdsb2JhbENvbW1lbnRzLGRpdi5jb21tZW50c1BhbmUsLnRiLXRpdGxlLWljb25zLCN0b29sdGlwLCNmaWxlYnJvd3Nlci1wb3B1cCwjc2VhcmNocGFuZWwtcG9wdXAsI3VzZXItbWVudXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0uc3VibWl0LWhpbnQsYVtjbGFzcyo9XCItYnV0dG9uXCJdLGlbY2xhc3MqPVwiaWNvbi1cIl0sc2VsZWN0e2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5yZXN1bHRzIC5wbG90LWNvbnRyb2xze2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWFbY2xhc3M9XCJjYW5jZWwtcXVlcnktYnV0dG9uXCJde2Rpc3BsYXk6YmxvY2sgIWltcG9ydGFudH0udGItc3RhdHVzLC50Yi1zdGF0dXMgaW1ne2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tYW5kLXJlc3VsdCAuc3Bpbm5lciAuc3Bpbm5lci13cmFwcGVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWh0bWwsYm9keSwuc2hlbGxTZXNzaW9uVmlld3tvdmVyZmxvdzpoaWRkZW4gIWltcG9ydGFudH10ZXh0YXJlYTplbXB0eXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1kaXYucHJpbWFyeVByb21wdHtkaXNwbGF5Om5vbmUgIWltcG9ydGFudH1kaXYuZGl2aWRlcntkaXNwbGF5Om5vbmUgIWltcG9ydGFudH0uY29tbWFuZHtib3JkZXI6bm9uZSAhaW1wb3J0YW50fSo6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0qOi1tb3otcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0qOjotbW96LXBsYWNlaG9sZGVye2NvbG9yOnRyYW5wYXJlbnR9KjotbXMtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6dHJhbnBhcmVudH0uZXhwYW5kaW5nVGV4dHttaW4taGVpZ2h0OmluaXRpYWwgIWltcG9ydGFudH0uY29tbWVudEZyYW1lIC5jb21tZW50LWxpc3QgbGl7bWFyZ2luOjB9LmNvbW1lbnRGcmFtZSAuaGVhZGVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tZW50RnJhbWUgLm5ldy1jb21tZW50e2JvcmRlci1ib3R0b206bm9uZSAhaW1wb3J0YW50fWRpdi5kaXZpZGVyOmhvdmVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWRpdi5kaXZpZGVyOmhvdmVyIC5idG4tY2lyY2xle2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fS5jb21tYW5kOmhvdmVyLC5jb21tYW5kOmFjdGl2ZXtib3JkZXI6bm9uZSAhaW1wb3J0YW50O2JveC1zaGFkb3c6bm9uZSAhaW1wb3J0YW50fUBwYWdle21hcmdpbjoyY219Ym9keXttYXgtd2lkdGg6MTAwJSAhaW1wb3J0YW50fS51aS1yZXNpemFibGV7bWF4LWhlaWdodDoxMDAlO21heC13aWR0aDoxMDAlfS5maWd1cmUtcmVzdWx0cy1hbmQtY29tbWVudHMgLndpZGdldFtzdHlsZSo9XCJ3aWR0aDogYXV0bzsgaGVpZ2h0OiBhdXRvXCJde3dpZHRoOjEwMCUgIWltcG9ydGFudDttaW4taGVpZ2h0OjMwMHB4fS53aWRnZXQud2lkZ2V0LWlucHV0e21pbi1oZWlnaHQ6aW5pdGlhbCAhaW1wb3J0YW50fUAtbW96LWRvY3VtZW50IHVybC1wcmVmaXgoKXsudWktcmVzaXphYmxle3dpZHRoOmF1dG8gIWltcG9ydGFudDtoZWlnaHQ6YXV0byAhaW1wb3J0YW50O21heC13aWR0aDoxMDAlfX1pbWcsLmZpZ3VyZSwudWktcmVzaXplYWJsZXtwYWdlLWJyZWFrLWluc2lkZTphdm9pZH0ucHJldmlvdXNQcm9tcHR7cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LmNvbW1hbmQgLmNvbW1hbmQtaW5wdXQgLmNvbW1hbmQtYm94e3BhZ2UtYnJlYWstYmVmb3JlOmF2b2lkfS5yZXN1bHRzLWFuZC1jb21tZW50c3twYWdlLWJyZWFrLWJlZm9yZTphdm9pZH0ucmVzdWx0cy1hbmQtY29tbWVudHMuZmlndXJlLXJlc3VsdHMtYW5kLWNvbW1lbnRze3BhZ2UtYnJlYWstYmVmb3JlOmF1dG87cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LmNvbW1hbmQgLnVpLXJlc2l6ZWFibGV7cGFnZS1icmVhay1pbnNpZGU6YXZvaWR9LnRhYmxlLWJvcmRlcmVke2JvcmRlcjoxcHggc29saWQgI2RkZH0ucmVzdWx0cyAudGFibGUgdGhlYWQsLnRhYmxlIHRoZWFke2JhY2tncm91bmQ6I2ZhZmFmYX0uY29tbWFuZC1yZXN1bHQtd3JhcHBlciAucmVzdWx0c3tvdmVyZmxvdzpoaWRkZW59LnJlc3VsdHMtdGFibGUgLmlubmVye292ZXJmbG93OmhpZGRlbn0jY29udGVudHtvdmVyZmxvdy15OnZpc2libGV9LmNvbW1lbnRGcmFtZXtvdmVyZmxvdzp2aXNpYmxlO21hcmdpbi1ib3R0b206MjVweH0uY29tbWVudEZyYW1lIC5uZXctY29tbWVudHtib3JkZXItYm90dG9tOm5vbmV9LmNvbW1lbnRGcmFtZSAubWFpbiwuY29tbWVudEZyYW1lIC5jb21tZW50LWxpc3R7b3ZlcmZsb3cteTp2aXNpYmxlO21heC1oZWlnaHQ6aW5pdGlhbDtoZWlnaHQ6YXV0b30uc2Vzc2lvblBhbmUgLnNoZWxsLXRvcD5kaXY6bGFzdC1jaGlsZCAucmVzdWx0c3twYWRkaW5nLWJvdHRvbTo1MHB4O292ZXJmbG93OnZpc2libGV9Il19 */

</style>
<link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABzklEQVQ4jbWTTU8TURSGT+mdKQIm2nZmbocBnDYmbkysEZrSQkr4CBqBlmjc6d4VP8CFO/4A/8W9K+PGlWA7txD8iITSdvgoJVr6usBeGAaBjSc5i3vPec7Nec89RP/Ldkb110czZr352Gq6GWMZRF3XAusjkVeHU1YFiwmc9cPpgcbuqPHmn6CbCj9rTMZ+ngd9hSYH96ppY8kLZ4y1q8Dz3pgwt/GcgkREJEwVlWQYrXn7SvB4IY7aiIayFcJbIkZERA5X4HAF5X4V1eEojhf8hdqFONy0jvWBbnTyZYE1znIlg33oBNatEGopDe18HCgksJfl2Bi6IUGHs6LQ1BceHappY8nN6s0f927KxI3BbmzaPfL8NdGLeoa3ahltBbm/rxMR1cf17x6lpyx8u9snwU27B/vjMU9LzZzpShEdrmDr/i38ejLkSTrImdjNcqBweteas1FJhiFM1S+iiCnYfnAbv5/euUB9G9VHUZT7Vb+IjkbJL1x9JwuZKioPI2jN22jn46ilTsbWiRej7ONqmE37fuNnjcaExt6fjjXkGVspylaFGcyDKHDpPogYmy3pgU8SNLrKQg++vPZCERGBKFCMKMOCswnZ6wX2B+RRbGQlT7ocAAAAAElFTkSuQmCC">
<meta http-equiv="content-type" content="text/html; charset=UTF8">


<script>window.settings = {"sparkDocsSearchGoogleCx":"","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"isAdmin":false,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":false,"hideOffHeapCache":false,"applications":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3","packageLabel":"spark-1.3-jenkins-ip-10-2-0-138-Ub38c68475d-Sb38c68475d-2015-11-04-01:34:17.300434","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4","packageLabel":"spark-1.4-jenkins-ip-10-2-0-138-Ub38c68475d-Sb38c68475d-2015-11-04-01:34:17.300434","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-Ub38c68475d-Sb38c68475d-2015-11-04-01:34:17.300434","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":false,"sparkHistoryServerEnabled":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.6.1","local":false,"displayDefaultContainerMemoryGB":30,"useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableR":true,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"gitTimestamp":"2015-11-03 17:15:01 -0800","defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5","packageLabel":"spark-1.5-jenkins-ip-10-2-0-138-Ub38c68475d-Sb38c68475d-2015-11-04-01:34:17.300434","upgradable":true,"deprecated":false,"customerVisible":true},"staticNotebookCdnUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/","clusterPublisherRootId":72512,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableClusterDeltaUpdates":true,"csrfToken":"156cfc2d-cd97-4dbb-9147-a93d8962d7f3","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":true,"gitHash":"b38c68475dfc920d015b8b9c64a2676d63f65035","userFullname":"Jules Damji","enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":true,"userId":100101,"dbcSupportURL":"http://help.databricks.com","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableSparkVersionsUI":true,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"dmatrix@comcast.net","enableServerAutoComplete":true,"defaultMemoryPerContainerMB":28000,"enablePresenceUI":true,"tablesPublisherRootId":72523,"accounts":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"zoneInfos":[{"id":"us-west-2a","isDefault":true},{"id":"us-west-2b","isDefault":false}],"defaultZoneId":"us-west-2a"};</script>

<script>var notebookModelJson = {"clusterMemory":240,"name":"chap5_example","path":"/51286/87080/87855/87878","guid":"bd7e384a-052b-4da0-ac7b-efbd9fedfeba","jsRunAllAction":"NoAction","iPythonMetadata":null,"runStatus":"idle","clusterId":"1111-021412-elder48","id":87878,"driver":6546706783076015000,"language":"python","deltaVersion":1446693362258,"targetClusterId":"1111-021412-elder48","deltaEvent":"update","type":"shell","clusterReady":true,"clusterName":"default-spot","doNotFireCallback":true,"parentId":87855,"globalVars":{},"notebookFetchError":null,"permissionLevel":"Can Manage","presenceMarks":[],"latestUser":"dmatrix@comcast.net"};</script>

<script>var notebookModelCommandCollection = [{"type":"command","id":87880,"parentId":87878,"deltaVersion":1446693351744,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"3ffe160b-00ae-4b53-99c1-2f7386491e28","subtype":"command","commandType":"auto","position":1,"command":"%md # **Learning Spark Chapter 5, Loading and Saving your Data, Examples in Python**\n\n[![Learning Spark](http://akamaicovers.oreilly.com/images/0636920028512/cat.gif)](http://www.jdoqocy.com/click-7645222-11260198?url=http%3A%2F%2Fshop.oreilly.com%2Fproduct%2F0636920028512.do%3Fcmp%3Daf-strata-books-videos-product_cj_9781449358600_%2525zp&cjsku=0636920028512)\n\nMany of the examples in Chapter 5 require access to certain storage systems, these examples have been left out. For Databricks Cloud you should consider using the table creation mechanism.","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1418342147540,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"1b3014b6-a4ec-474a-9bf2-9898c27dac00","globalVars":{},"iPythonMetadata":null,"path":"/51286/87080/87855/87878/87880","parent":null,"localVersion":27,"presenceMarks":[],"arguments":{},"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":87881,"parentId":87878,"deltaVersion":1446693351745,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"9a1b4c8d-225a-4fe8-9845-8d7cb07ef57d","subtype":"command","commandType":"auto","position":1.5,"command":"%md ## S3 setup\n\nNote: If you have '/' characters in your secret access key, they must be escaped with '%2F'","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1418342147456,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"8ce413be-3759-4204-a992-835659a527a1","globalVars":{},"iPythonMetadata":null,"path":"/51286/87080/87855/87878/87881","parent":null,"localVersion":27,"presenceMarks":[],"arguments":{},"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":87882,"parentId":87878,"deltaVersion":0,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"ed176ec0-4961-44fd-af4c-e7b700612c58","subtype":"command","commandType":"auto","position":1.75,"command":"ACCESS_KEY = \"YOUR ACCESS KEY GOES HERE\"\nSECRET_KEY = \"YOUR SECRET KEY GOES HERE\"","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1418344945467,"submitTime":1418344945457,"finishTime":1418344945542,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"3e5f93ad-af49-4ff8-a6c9-cef662c40475","globalVars":{},"iPythonMetadata":null,"path":"/51286/87080/87855/87878/87882","parent":null,"localVersion":23,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":87883,"parentId":87878,"deltaVersion":1446693351746,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"030cc2bd-068c-43e8-a39c-06e7e53a6607","subtype":"command","commandType":"auto","position":2,"command":"%md ## Example 5-1. Python load text file example","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1418342147440,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"64701a78-8539-451f-9078-6be69606e37f","globalVars":{},"iPythonMetadata":null,"path":"/51286/87080/87855/87878/87883","parent":null,"localVersion":27,"presenceMarks":[],"arguments":{},"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":87884,"parentId":87878,"deltaVersion":1446693356192,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"f8c2b29d-55bf-4dcd-a8a8-4f1ea0d92a7a","subtype":"command","commandType":"auto","position":3,"command":"from pyspark import Row\nfrom pyspark.sql import *\n\ninput = sc.textFile(\"file:///dbfs/learning-spark-master/files/*.txt\")\ninputWords = input.flatMap(lambda l: l.split()).map(lambda w: w.lower())\npairs = inputWords.map(lambda w: (w, 1))\nwordCount = pairs.reduceByKey(lambda x, y: x + y)\nwordRowRDD = wordCount.map(lambda p: Row(word= p[0], value=p[1]))\nwordDF = sqlContext.createDataFrame(wordRowRDD)\ndisplay(wordDF)","commandVersion":0,"results":{"overflow":false,"data":[[1,"email."],[6,"and"],[1,"being"],[1,"had"],[1,"am"],[1,"bro"],[2,"need"],[1,"kingdom"],[2,"dear"],[1,"of."],[1,"infected!"],[1,"access"],[2,"from"],[1,"question"],[1,"late"],[1,"fred,"],[1,"apologies"],[1,"was"],[1,"it."],[3,"a"],[1,"drugs"],[2,"cheap"],[1,"please"],[1,"let"],[1,"far"],[1,"talks"],[2,"not"],[1,"scam!"],[2,"with"],[1,"know."],[1,"reset"],[9,"i"],[1,"cheap!"],[5,"this"],[2,"try"],[1,"emailing"],[3,"so"],[1,"these"],[1,"kk6jkq"],[1,"real"],[2,"my"],[11,"..."],[1,"demo"],[1,"it"],[2,"heard"],[3,"thanks"],[1,"--joe"],[1,"yet"],[1,"enjoyed"],[1,"take"],[1,"check"],[1,"transfer"],[1,"hey"],[1,"prince"],[13,"to"],[1,"too"],[3,"money"],[1,"got"],[1,"email"],[1,"can"],[1,"be"],[1,"tried"],[2,"attending"],[1,"user"],[1,"reply"],[1,"immediately"],[1,"advance"],[6,"your"],[1,"learner,"],[2,"list,"],[1,"of"],[1,"alice"],[1,"forgetting"],[1,"either"],[1,"found"],[1,"think"],[1,"at"],[2,"want"],[1,"package."],[1,"whoops"],[1,"them"],[1,"one."],[1,"rainforest."],[2,"been"],[3,"have"],[1,"password."],[1,"just"],[5,"for"],[1,"away"],[4,"send"],[1,"viagra"],[1,"videos"],[8,"you"],[2,"is"],[1,"haven't"],[1,"we"],[1,"audience!"],[1,"sir,"],[1,"running"],[4,"spark"],[1,"graphx"],[2,"about"],[1,"job"],[1,"hope"],[1,"petabyte"],[5,"the"],[1,"awesome"],[1,"via"],[1,"wire"],[1,"mom,"],[1,"oh"],[1,"wow,"],[2,"right"],[3,"in"],[1,"gosh"],[1,"help!"],[3,"really"],[1,"has"],[1,"ssn"],[1,"password"],[1,"computer"],[1,"that"],[1,"stuff"],[1,"much"],[1,"strong"],[1,"tom"],[3,"get"],[4,"out"],[1,"refer"],[1,"good"],[1,"talk,"],[1,"never"],[2,"hi"],[1,"part"],[1,"now"],[1,"must"],[1,"figured"],[1,"yesterday!"],[1,"sort."],[3,"summit"],[1,"time"],[1,"2014!"],[1,"first"]],"plotOptions":null,"aggType":"","aggSchema":[],"schema":[{"name":"value","type":"bigint"},{"name":"word","type":"string"}],"aggError":"","aggData":[],"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;RemoteContext&apos; object has no attribute &apos;createDataFrame&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-47-b0f7de91446a&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      7</span> wordCount <span class=\"ansiyellow\">=</span> pairs<span class=\"ansiyellow\">.</span>reduceByKey<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">,</span> y<span class=\"ansiyellow\">:</span> x <span class=\"ansiyellow\">+</span> y<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span> wordRowRDD <span class=\"ansiyellow\">=</span> wordCount<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> p<span class=\"ansiyellow\">:</span> Row<span class=\"ansiyellow\">(</span>word<span class=\"ansiyellow\">=</span> p<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> value<span class=\"ansiyellow\">=</span>p<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 9</span><span class=\"ansiyellow\"> </span>wordDF <span class=\"ansiyellow\">=</span> sc<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>wordRowRDD<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;RemoteContext&apos; object has no attribute &apos;createDataFrame&apos;\n</div>","startTime":1447960901580,"submitTime":1447960883284,"finishTime":1447960904646,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"7f48cc40-a239-4f4e-9265-5b0025479355","globalVars":{},"iPythonMetadata":null,"clusterName":"","arguments":{},"path":"/51286/87080/87855/87878/87884","sparkCtxId":"635503691979815030","clusterId":"","clusterMemory":0,"parent":null,"localVersion":749,"presenceMarks":[],"comments":null,"deltaEvent":"update"},{"type":"command","id":87885,"parentId":87878,"deltaVersion":1446693361908,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"1d8bdeb4-562d-4c6b-a1ac-44c3cd321b0c","subtype":"command","commandType":"auto","position":4,"command":"%md ## Example 5-6. Python load unstructured JSON example","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":1418342147525,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"markdown","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":null,"lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"bf99d189-21ef-445a-905c-6f58a4b78b07","globalVars":{},"iPythonMetadata":null,"arguments":{},"path":"/51286/87080/87855/87878/87885","parent":null,"localVersion":85,"presenceMarks":[],"comments":null,"deltaEvent":"update","clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","id":87886,"parentId":87878,"deltaVersion":1446693351926,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"guid":"b3ba9dd6-1860-4250-a489-df1122519823","subtype":"command","commandType":"auto","position":6,"command":"# Import SparkFiles\nfrom pyspark import SparkFiles\nimport json\n# Fetch the remote example since it isn't on local FS or S3\n# Load the file into an RDD\njsonInput = sc.textFile(\"file:///dbfs/learning-spark-master/files/testweet.json\")\njsonInput.collect()\n#Parse it\ndata = jsonInput.map(lambda x: json.loads(x))\n# Collect the parsed results back to the driver\ndata.collect()","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">38</span><span class=\"ansired\">]: </span>\n[{u&apos;contributorsIDs&apos;: [],\n  u&apos;createdAt&apos;: u&apos;Nov 4, 2014 4:56:59 PM&apos;,\n  u&apos;currentUserRetweetId&apos;: -1,\n  u&apos;hashtagEntities&apos;: [],\n  u&apos;id&apos;: 529799371026485248,\n  u&apos;inReplyToStatusId&apos;: -1,\n  u&apos;inReplyToUserId&apos;: -1,\n  u&apos;isFavorited&apos;: False,\n  u&apos;isPossiblySensitive&apos;: False,\n  u&apos;isTruncated&apos;: False,\n  u&apos;mediaEntities&apos;: [],\n  u&apos;retweetCount&apos;: 0,\n  u&apos;source&apos;: u&apos;&lt;a href=&quot;http://twitter.com&quot; rel=&quot;nofollow&quot;&gt;Twitter Web Client&lt;/a&gt;&apos;,\n  u&apos;text&apos;: u&apos;Adventures With Coffee, Code, and Writing.&apos;,\n  u&apos;urlEntities&apos;: [],\n  u&apos;user&apos;: {u&apos;createdAt&apos;: u&apos;Aug 5, 2011 9:42:44 AM&apos;,\n   u&apos;description&apos;: u&apos;&apos;,\n   u&apos;descriptionURLEntities&apos;: [],\n   u&apos;favouritesCount&apos;: 1095,\n   u&apos;followersCount&apos;: 1231,\n   u&apos;friendsCount&apos;: 600,\n   u&apos;id&apos;: 15594928,\n   u&apos;isContributorsEnabled&apos;: False,\n   u&apos;isFollowRequestSent&apos;: False,\n   u&apos;isGeoEnabled&apos;: True,\n   u&apos;isProtected&apos;: False,\n   u&apos;isVerified&apos;: False,\n   u&apos;lang&apos;: u&apos;en&apos;,\n   u&apos;listedCount&apos;: 0,\n   u&apos;location&apos;: u&apos;&apos;,\n   u&apos;name&apos;: u&apos;Holden Karau&apos;,\n   u&apos;profileBackgroundColor&apos;: u&apos;C0DEED&apos;,\n   u&apos;profileBackgroundImageUrl&apos;: u&apos;&apos;,\n   u&apos;profileBackgroundImageUrlHttps&apos;: u&apos;&apos;,\n   u&apos;profileBackgroundTiled&apos;: True,\n   u&apos;profileBannerImageUrl&apos;: u&apos;&apos;,\n   u&apos;profileImageUrl&apos;: u&apos;http://pbs.twimg.com/profile_images/3005696115/2036374bbadbed85249cdd50aac6e170_normal.jpeg&apos;,\n   u&apos;profileImageUrlHttps&apos;: u&apos;https://pbs.twimg.com/profile_images/3005696115/2036374bbadbed85249cdd50aac6e170_normal.jpeg&apos;,\n   u&apos;profileLinkColor&apos;: u&apos;0084B4&apos;,\n   u&apos;profileSidebarBorderColor&apos;: u&apos;FFFFFF&apos;,\n   u&apos;profileSidebarFillColor&apos;: u&apos;DDEEF6&apos;,\n   u&apos;profileTextColor&apos;: u&apos;333333&apos;,\n   u&apos;profileUseBackgroundImage&apos;: True,\n   u&apos;screenName&apos;: u&apos;holdenkarau&apos;,\n   u&apos;showAllInlineMedia&apos;: False,\n   u&apos;statusesCount&apos;: 6234,\n   u&apos;translator&apos;: False,\n   u&apos;utcOffset&apos;: -3},\n  u&apos;userMentionEntities&apos;: []}]\n</div>","arguments":{},"plotOptions":null},"errorSummary":null,"error":null,"startTime":1447960469129,"submitTime":1447960450812,"finishTime":1447960471150,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":null,"latestUser":"dmatrix@comcast.net","lastModifiedBy":"","diffInserts":null,"diffDeletes":null,"nuid":"54fc6372-1fd5-4a3d-98f3-ec250abfbf6d","globalVars":{},"iPythonMetadata":null,"clusterName":"","arguments":{},"path":"/51286/87080/87855/87878/87886","sparkCtxId":"635503691979815030","clusterId":"","clusterMemory":0,"parent":null,"localVersion":30,"presenceMarks":[],"comments":null,"deltaEvent":"update"},{"type":"command","id":87998,"parentId":87878,"deltaVersion":-1,"running":false,"state":"input","shouldRun":false,"rerunning":false,"stages":[],"guid":"762c04e1-ed50-4308-b8a8-21b3ad692220","subtype":"command","commandType":"auto","position":7,"command":"","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"latestUser":"","lastModifiedBy":"","diffInserts":[],"diffDeletes":[],"nuid":"b2a05185-e9bc-4d00-ae81-762987b73c98","globalVars":{},"iPythonMetadata":null,"path":"/51286/87080/87855/87878/87998","parent":null,"localVersion":23,"presenceMarks":[],"comments":null,"clusterId":"","clusterName":"","clusterMemory":0},{"type":"dashboardV2","id":87879,"parentId":87878,"defaultSize":{"width":1024,"height":768},"guid":"b9d905a9-00f3-4d29-8fd8-1f4bbc3529dc","globalVars":{},"path":"/51286/87080/87855/87878/87879","parent":null,"nuid":"4023862a-dda7-45bf-8ab3-65024832e03c","presenceMarks":[]},{"type":"command","commandText":"","position":2.5,"guid":"2256641b-fa9f-4f08-b3c9-2441cab019fc","lastModifiedBy":"","parent":null,"deltaVersion":1446693361916,"localVersion":178,"running":false,"state":"input","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"%md Read all text files from the directory and do a word count on them. With the (k,v) pair RDD, make Rows of RDDs and create a dataframe. \nSave it as a temp table and issue some example queries ","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/51286/87080/87855/87878/88000","subtype":"command","customPlotOptions":{},"iPythonMetadata":null,"pivotAggregation":null,"nuid":"b5b9a97d-aea6-4b48-8d2e-ef6fa34e03bc","id":88000,"inputWidgets":{},"deltaEvent":"update","latestUser":"","parentId":87878,"globalVars":{},"arguments":{},"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","commandText":"","position":3.5,"guid":"6d4d2329-bfc8-45ca-a4db-ee127e984da3","lastModifiedBy":"","parent":null,"deltaVersion":1446693356207,"localVersion":39,"running":false,"state":"input","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"%md Register dataframe as a temporary table","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/51286/87080/87855/87878/88001","subtype":"command","customPlotOptions":{},"iPythonMetadata":null,"pivotAggregation":null,"nuid":"3b8c5680-b802-45be-bf67-bce4df771e97","id":88001,"inputWidgets":{},"deltaEvent":"update","latestUser":"","parentId":87878,"globalVars":{},"arguments":{},"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","commandText":"","position":3.75,"guid":"51620f72-0b83-4f26-855a-a6444b852cce","lastModifiedBy":"","parent":null,"deltaVersion":1446693356763,"localVersion":76,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"wordDF.registerTempTable(\"wordcount\")","commandVersion":0,"results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;registerAsTempTable&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-50-8dd284d1839a&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">----&gt; 1</span><span class=\"ansiyellow\"> </span>wordDF<span class=\"ansiyellow\">.</span>registerAsTempTable<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;wordcount&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/home/ubuntu/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">__getattr__</span><span class=\"ansiblue\">(self, name)</span>\n<span class=\"ansigreen\">    747</span>         <span class=\"ansigreen\">if</span> name <span class=\"ansigreen\">not</span> <span class=\"ansigreen\">in</span> self<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    748</span>             raise AttributeError(\n<span class=\"ansigreen\">--&gt; 749</span><span class=\"ansiyellow\">                 &quot;&apos;%s&apos; object has no attribute &apos;%s&apos;&quot; % (self.__class__.__name__, name))\n</span><span class=\"ansigreen\">    750</span>         jc <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>apply<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    751</span>         <span class=\"ansigreen\">return</span> Column<span class=\"ansiyellow\">(</span>jc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;DataFrame&apos; object has no attribute &apos;registerAsTempTable&apos;\n</div>","startTime":1447961188264,"submitTime":1447961169951,"finishTime":1447961188311,"collapsed":false,"bindings":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/51286/87080/87855/87878/88002","subtype":"command","customPlotOptions":{},"iPythonMetadata":null,"pivotAggregation":null,"nuid":"1fbe5ba5-d015-4e01-8140-75d0c5c121cb","id":88002,"inputWidgets":{},"deltaEvent":"update","latestUser":"dmatrix@comcast.net","parentId":87878,"globalVars":{},"sparkCtxId":"635503691979815030","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","commandText":"","position":3.875,"guid":"639be0d2-a634-44c7-adcf-64b582e2a65a","lastModifiedBy":"","parent":null,"deltaVersion":1446693356954,"localVersion":27,"running":false,"state":"input","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"%md Issue some SQL queries","commandVersion":0,"results":null,"errorSummary":null,"error":null,"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/51286/87080/87855/87878/88004","subtype":"command","customPlotOptions":{},"iPythonMetadata":null,"pivotAggregation":null,"nuid":"aea10a2d-ff2f-46a7-af41-ca74d6f35b97","id":88004,"inputWidgets":{},"deltaEvent":"update","latestUser":"","parentId":87878,"globalVars":{},"arguments":{},"clusterId":"","clusterName":"","clusterMemory":0},{"type":"command","commandText":"","position":3.9375,"guid":"6f50a33e-0b5c-4ee2-9011-aca40aa67cd1","lastModifiedBy":"","parent":null,"deltaVersion":1446693358566,"localVersion":91,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"%sql select word, value from wordcount where value >= 5","commandVersion":0,"results":{"overflow":false,"data":[["i",9],["and",6],["this",5],["your",6],["to",13],["...",11],["for",5],["you",8],["the",5]],"plotOptions":null,"aggType":"","aggSchema":[],"schema":[{"name":"word","type":"string"},{"name":"value","type":"bigint"}],"aggError":"","aggData":[],"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}},"errorSummary":null,"error":null,"startTime":1447961314900,"submitTime":1447961296595,"finishTime":1447961315086,"collapsed":false,"bindings":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/51286/87080/87855/87878/88005","subtype":"command","customPlotOptions":{},"iPythonMetadata":null,"pivotAggregation":null,"nuid":"fd81aca7-0432-4c34-8257-5098039a08ca","id":88005,"inputWidgets":{},"deltaEvent":"update","latestUser":"dmatrix@comcast.net","parentId":87878,"globalVars":{},"sparkCtxId":"635503691979815030","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}},{"type":"command","commandText":"","position":3.96875,"guid":"f6d663c1-5adc-4c9d-bc17-422a6a6b80a8","lastModifiedBy":"","parent":null,"deltaVersion":1446693361910,"localVersion":30,"running":false,"state":"finished","shouldRun":false,"rerunning":false,"stages":[],"commandType":"auto","command":"display (wordDF)","commandVersion":0,"results":{"overflow":false,"data":[[1,"email."],[6,"and"],[1,"being"],[1,"had"],[1,"am"],[1,"bro"],[1,"talks"],[1,"kingdom"],[2,"dear"],[1,"of."],[1,"infected!"],[1,"access"],[2,"from"],[1,"question"],[1,"late"],[1,"fred,"],[2,"need"],[1,"apologies"],[1,"was"],[1,"it."],[3,"a"],[1,"drugs"],[2,"cheap"],[1,"please"],[1,"let"],[1,"far"],[2,"not"],[1,"scam!"],[2,"with"],[1,"know."],[1,"reset"],[9,"i"],[1,"cheap!"],[5,"this"],[2,"try"],[1,"emailing"],[3,"so"],[1,"these"],[1,"kk6jkq"],[1,"real"],[2,"my"],[1,"be"],[1,"demo"],[1,"enjoyed"],[1,"it"],[2,"heard"],[1,"at"],[1,"--joe"],[1,"yet"],[6,"your"],[1,"transfer"],[1,"prince"],[1,"hey"],[1,"check"],[13,"to"],[1,"take"],[3,"money"],[1,"got"],[1,"email"],[1,"too"],[11,"..."],[1,"tried"],[2,"attending"],[1,"user"],[1,"reply"],[1,"immediately"],[1,"advance"],[1,"learner,"],[2,"list,"],[1,"of"],[1,"alice"],[1,"can"],[1,"forgetting"],[1,"either"],[1,"found"],[1,"think"],[3,"thanks"],[2,"want"],[1,"videos"],[2,"is"],[1,"whoops"],[1,"them"],[1,"one."],[1,"rainforest."],[2,"been"],[3,"have"],[1,"password."],[1,"just"],[5,"for"],[1,"away"],[4,"send"],[1,"viagra"],[8,"you"],[1,"awesome"],[1,"haven't"],[1,"we"],[1,"audience!"],[1,"sir,"],[1,"running"],[4,"spark"],[1,"graphx"],[1,"package."],[2,"about"],[1,"job"],[1,"hope"],[1,"petabyte"],[5,"the"],[1,"now"],[1,"via"],[3,"in"],[1,"wow,"],[1,"computer"],[2,"right"],[1,"mom,"],[1,"gosh"],[3,"really"],[1,"wire"],[1,"talk,"],[1,"that"],[1,"much"],[1,"strong"],[1,"tom"],[2,"hi"],[1,"has"],[1,"refer"],[1,"good"],[3,"get"],[1,"never"],[1,"ssn"],[1,"part"],[1,"password"],[1,"must"],[3,"summit"],[1,"figured"],[1,"oh"],[1,"help!"],[1,"sort."],[1,"stuff"],[1,"yesterday!"],[1,"time"],[4,"out"],[1,"2014!"],[1,"first"]],"plotOptions":null,"aggType":"","aggSchema":[],"schema":[{"name":"value","type":"bigint"},{"name":"word","type":"string"}],"aggError":"","aggData":[],"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}},"errorSummary":null,"error":null,"startTime":1447969612207,"submitTime":1447969593686,"finishTime":1447969612301,"collapsed":false,"bindings":{},"displayType":"barChart","width":660,"height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"presenceMarks":[],"comments":null,"path":"/51286/87080/87855/87878/88008","subtype":"command","customPlotOptions":{},"iPythonMetadata":null,"pivotAggregation":null,"nuid":"c9acc9fc-6a48-413e-8529-eb4437b183b4","id":88008,"inputWidgets":{},"deltaEvent":"update","latestUser":"dmatrix@comcast.net","parentId":87878,"globalVars":{},"sparkCtxId":"635503691979815030","clusterId":"","clusterMemory":0,"clusterName":"","arguments":{}}];</script>

<script src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201511031715010800-b38c68475dfc920d015b8b9c64a2676d63f65035/notebook-main.js" onerror="window.mainJsLoadError=true"></script>
</head>
<body>

<script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201511031715010800-b38c68475dfc920d015b8b9c64a2676d63f65035/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = '<h1>Network Error</h1><p><b>Please check your network connection and try again.</b></p><p>Could not load a required resource: ' + u + '</p>';
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
};
</script>
</body>
</html>